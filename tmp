#!/bin/bash

# Fichier contenant les exports
VAR_FILE="variable.sh"

# RÃ©pertoire contenant tes scripts
SCRIPTS_DIR="./scripts"

echo "ğŸ” VÃ©rification des variables dÃ©finies dans $VAR_FILE..."

# RÃ©cupÃ©ration des variables exportÃ©es
VARS=$(grep -oP '^[[:space:]]*export[[:space:]]+\K[[:alnum:]_]+(?==)' "$VAR_FILE")

# VÃ©rification de lâ€™utilisation
for var in $VARS; do
    if grep -R --exclude="$VAR_FILE" "\b$var\b" "$SCRIPTS_DIR" >/dev/null 2>&1; then
        echo "âœ”ï¸ $var est utilisÃ©"
    else
        echo "âš ï¸ $var n'est pas utilisÃ©"
    fi
done





for var in $VARS; do
    if grep -R --exclude="$VAR_FILE" -E "\${$var}|\$$var" "$SCRIPTS_DIR" >/dev/null 2>&1; then
        echo "âœ”ï¸ $var est utilisÃ©"
    else
        echo "âš ï¸ $var n'est pas utilisÃ©"
    fi
done



for var in $VARS; do
    echo "ğŸ‘‰ Je cherche $var"
    if grep -R --exclude="$VAR_FILE" -E "\\\$$var|\\\${$var}" "$SCRIPTS_DIR" >/dev/null 2>&1; then
        echo "âœ”ï¸ $var est utilisÃ©"
    else
        echo "âš ï¸ $var n'est pas utilisÃ©"
    fi
done






echo "DEBUG : grep -R -E \"\\\$$var|\\\${$var}\" $SCRIPTS_DIR"




#!/bin/bash

# Fichier contenant les exports
VAR_FILE="/home/maitelka/script/env_std.sh"

# RÃ©pertoire contenant tes scripts
SCRIPTS_DIR="/home/maitelka/script/toCheck"

# Mode debug (1 = activÃ©, 0 = dÃ©sactivÃ©)
DEBUG=1

echo "ğŸ” VÃ©rification des variables dÃ©finies dans $VAR_FILE..."
echo "ğŸ‘‰ Recherche dans : $SCRIPTS_DIR"

# RÃ©cupÃ©ration des variables exportÃ©es (avec ou sans =)
VARS=$(grep -oP '^[[:space:]]*export[[:space:]]+\K[[:alnum:]_]+' "$VAR_FILE")

# VÃ©rification de lâ€™utilisation
for var in $VARS; do
    # Construire le motif de recherche
    PATTERN="\\\$$var|\\\${$var}"

    # Debug optionnel
    if [ "$DEBUG" -eq 1 ]; then
        echo "DEBUG : grep -R -E \"$PATTERN\" $SCRIPTS_DIR"
    fi

    if grep -R --exclude="$VAR_FILE" -E "$PATTERN" "$SCRIPTS_DIR" >/dev/null 2>&1; then
        echo "âœ”ï¸ $var est utilisÃ©"
    else
        echo "âš ï¸ $var n'est pas utilisÃ©"
    fi
done
